{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "../../App.svelte",
    "../../Axes.svelte",
    "../../Individual.svelte"
  ],
  "sourcesContent": [
    "<script>\n\timport * as d3 from 'd3';\n\n\timport { width, height, numExpandedIndividuals } from './stores.js';\n\timport Defs from './components/Defs.svelte';\n\timport Axes from './components/Axes.svelte';\n\timport Individual from './components/Individual.svelte';\n\n\tlet data = [];\n\n\t// Load the data\n\tconst load = () => {\n\t\td3.csv('data.csv', (d) => {\n\t\t\treturn {\n\t\t\t\tindividual: +d.ANON_ID,\n\t\t\t\tage: +d.age_years,\n\t\t\t\ttemp: +d.temp_C,\n\t\t\t\tdiagnosis: d.primary_dx,\n\t\t\t\tsex: d.GENDER\n\t\t\t};\n\t\t}).then((res) => {\n\t\t\tlet tmp = d3.nest()\n\t\t\t\t\t\t\t\t.key((d) => d.individual)\n\t\t\t\t\t\t\t\t.entries(res);\n\t\t\tdata = tmp.sort((a, b) => a.values[0].age > b.values[0].age ? 1 : -1);\n\t\t});\n\t}\n\n\tload();\n\n\tconst sexScale = d3.scaleOrdinal()\n\t\t\t\t\t\t\t\t\t\t.domain(['Female', 'Male'])\n\t\t\t\t\t\t\t\t\t\t.range(['#D84797', '#39A9DB']);\n\n\tconst diagnosesToShow = ['J01', 'J06', 'R05'];\n\n\t// Adjust scales to dimensions\n\t$: individualRowScale = d3.scaleLinear()\n\t\t\t.domain([0, data.length])\n\t\t\t.range([$width / 100, $width]);\n\n  $: ageScale = d3.scaleLinear()\n\t\t\t.domain(d3.extent([].concat(...data.map((d) => d.values.map((d) => d.age)))))\n\t\t\t.range([0.03 * $width, 0.97 * $width]);\n\n\t$: tempScale = d3.scaleLinear()\n\t\t\t.domain(d3.extent([].concat(...data.map((d) => d.values.map((d) => d.temp)))))\n\t\t\t.range([$height * 0.95, $height * 0.35]);\n</script>\n\n<div class=\"wrapper\">\n\t<div class=\"headline\">\n\t\t<h1>Human signatures</h1>\n\t</div>\n\t<div class=\"explanations\">\n\t\tWe are different – and our body temperature is as well.<br />It was the German physician Carl Reinhold August Wunderlich, who measured the temperatures of 25,000 patients leading to the accepted standard 37 degrees. The average human body temperature. Until today we believe that this is true.\n\t\tIn early 2020 a comprehensive study with temperature data points spanning the last 150 years appeared in the scientific journal <a href=\"https://elifesciences.org/articles/49555\">eLife</a>. Surprisingly, average body temperatures are constantly decreasing over past decades. Apart from that each individual has her and his own temperature profile over time.<br /><br />Explore them yourself by clicking on <span style=\"color: {sexScale('Female')};\">female</span> or <span style=\"color: {sexScale('Male')};\">male</span> bodies from the eLife study. A blue stamp <div class=\"dot\"></div> denotes a cold.\n\t</div>\n\t<div class=\"svg-wrapper\" bind:clientWidth={$width} bind:clientHeight={$height}>\n\t\t<svg xmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t width={$width}\n\t\t\t\t height={$height}>\n\t\t\t<Defs />\n\t\t\t<Axes ageScale={ageScale}\n\t\t\t\t\t\ttempScale={tempScale}\n\t\t\t\t\t\tshow={$numExpandedIndividuals > 0} />\n\t\t\t{#each data as individual, i}\n\t\t\t\t{#if ($width > 600 || i % 2 === 0)}\n\t\t\t\t\t<Individual x={individualRowScale(i)}\n\t\t\t\t\t\t\t\t\t\t\ty={Math.random() * $height / 10}\n\t\t\t\t\t\t\t\t\t\t\tdata={individual.values}\n\t\t\t\t\t\t\t\t\t\t\tsexScale={sexScale}\n\t\t\t\t\t\t\t\t\t\t\tageScale={ageScale}\n\t\t\t\t\t\t\t\t\t\t\ttempScale={tempScale}\n\t\t\t\t\t\t\t\t\t\t\tdiagnosesToShow={diagnosesToShow} />\n\t\t\t\t{/if}\n\t\t\t{/each}\n\t\t</svg>\n\t</div>\n\t<div class=\"disclaimer\">Higsch Data Visuals  |  <a href=\"https://www.linkedin.com/in/matthias-stahl/\">Matthias Stahl</a>  |  2020</div>\n</div>\n\n<style>\n\t.wrapper {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t}\n\n\t.headline {\n\t\tdisplay: flex;\n\t\talign-items: flex-end;\n\t\tjustify-content: space-between;\n\t\twidth: 95%;\n\t\tmargin: 1rem auto 0 auto;\n\t}\n\n\th1 {\n\t\tfont-family: 'Source Sans Pro', sans-serif;\n\t\tfont-size: 3rem;\n\t\tfont-weight: 200;\n\t\tcolor: var(--purple);\n\t}\n\n\t.explanations {\n\t\twidth: 95%;\n\t\tmargin: 0.7rem auto;\n\t\tfont-family: 'Source Sans Pro', sans-serif;\n\t\tfont-size: 1rem;\n\t\ttext-align: justify;\n\t\tline-height: 1.4;\n\t\tcolumn-count: 2;\n\t\tcolumn-gap: 2rem;\n\t}\n\n\t@media (max-width: 700px) {\n\t\t.explanations {\n\t\t\tcolumn-count: 1;\n\t\t}\n\t}\n\n\t.dot {\n\t\tdisplay: inline-block;\n\t\twidth: 0.7rem;\n\t\theight: 0.7rem;\n\t\tbackground: #5BC0EB;\n\t\tborder-radius: 50%;\n\t}\n\n\t.svg-wrapper {\n\t\tflex: 1;\n\t\tmin-height: 600px;\n\t\twidth: 100%;\n\t}\n\n\tsvg {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t}\n\n\t.disclaimer {\n\t\twidth: 100%;\n\t\tpadding: 1rem;\n\t\ttext-align: center;\n\t\tfont-family: 'Source Sans Pro', sans-serif;\n\t\tfont-size: 0.7rem;\n\t\tfont-weight: 200;\n\t}\n</style>\n",
    "<script>\n  import { fade } from 'svelte/transition';\n\n  import { width, height } from '../stores.js';\n\n  export let ageScale;\n  export let tempScale;\n  export let show = false;\n\n  const ageTicks = [20, 30, 40, 50, 60, 70];\n  const tempTicks = [36.5, 37.0, 37.5];\n</script>\n\n{#if show}\n  <g class=\"axes\" transition:fade>\n    <text class=\"label\" transform=\"translate(15 {tempScale.range()[0]}) rotate(-90)\">Age (years)</text>\n    <g class=\"axis-age\" transform=\"translate(0 {tempScale.range()[0]})\">\n      {#each ageTicks as tick}\n        <g transform=\"translate({ageScale(tick)} 0)\">\n          <text x=0 y=0>{tick.toPrecision(2)}</text>\n          <line x1=0 y1=-12 x2=0 y2=-21 />\n        </g>\n      {/each}\n    </g>\n    <g class=\"axis-temp\">\n      <text class=\"label\" transform=\"translate(15 {tempScale(37)}) rotate(-90)\">Temperature (°C)</text>\n      {#each tempTicks as tick}\n        <g transform=\"translate(0 {tempScale(tick)})\">\n          <line class:faint={tick !== 37} x1=55 y1=0 x2={$width} y2=0 />\n          <text x=25 y=4>{tick.toPrecision(3)}</text>\n        </g>\n      {/each}\n    </g>\n  </g>\n{/if}\n\n<style>\n  line {\n    stroke: var(--purple);\n    stroke-width: 0.2vmin;\n    stroke-opacity: 0.1;\n  }\n\n  .axis-temp line.faint {\n    stroke-opacity: 0.05;\n  }\n\n  text {\n    font-family: 'Source Sans Pro', sans-serif;\n    font-size: 0.8rem;\n    fill: var(--purple);\n    fill-opacity: 0.4;\n  }\n\n  .axis-age text {\n    text-anchor: middle;\n  }\n\n  .axis-temp text {\n    text-anchor: start;\n  }\n\n  text.label {\n    text-anchor: middle;\n  }\n</style>\n",
    "<script>\n  import { onMount } from 'svelte';\n  import * as d3 from 'd3';\n\n  import human from '../human.js';\n  import { width, height, numExpandedIndividuals } from '../stores.js';\n\n  export let x;\n  export let y;\n  export let data;\n  export let sexScale;\n  export let ageScale;\n  export let tempScale;\n  export let diagnosesToShow = [];\n  \n  let expanded = false;\n  let isBlurred = false;\n  let parentElement, humanElement, lineElement, lineBlurElement, rectElement, diseasesElement;\n  let humanLength, lineLength;\n  let color = 'white';\n\n  function animate(expanded) {\n    if (expanded) window.scrollTo(0, $height);\n\n    numExpandedIndividuals.update(n => Math.max(0, n + (expanded ? 1 : -1)));\n\n    d3.select(humanElement)\n      .transition().duration(1000)\n        .attr('stroke-dashoffset', expanded ? humanLength : 0);\n\n    d3.select(lineBlurElement)\n      .transition().duration(1000)\n        .attr('stroke-dashoffset', expanded ? 0 : -lineLength)\n        .transition().duration(1)\n          .attr('stroke-opacity', 0.6);\n\n    d3.select(lineElement)\n      .transition().duration(1000)\n        .attr('stroke-dashoffset', expanded ? 0 : -lineLength)\n        .on(expanded ? 'end' : 'start', expanded ? showDiseases : hideDiseases)\n        .transition().duration(1)\n          .attr('stroke-opacity', 1);\n\n    if (expanded && !isBlurred) {\n      d3.select(parentElement).selectAll('path.to-blur')\n        .transition().duration(5000).delay(5000)\n        .attr('stroke-opacity', 0.3)\n        .on('end', () => isBlurred = true);\n    } else if (!expanded || expanded && isBlurred) {\n      isBlurred = false;\n    }\n  }\n\n  function showDiseases() {\n    d3.select(diseasesElement).selectAll('circle')\n      .transition().duration(500)\n        .attr('r', diseaseRadius);\n  }\n\n  function hideDiseases() {\n    d3.select(diseasesElement).selectAll('circle')\n      .transition().duration(500)\n        .attr('r', 0);\n  }\n\n  onMount(() => {\n    // Create a random color\n    color = sexScale(data[0].sex);\n\n    // Get the path lengths\n    humanLength = d3.select(humanElement).node().getTotalLength();\n    lineLength = d3.select(lineElement).node().getTotalLength();\n\n    // Initialise the paths\n    d3.select(humanElement)\n      .attr('stroke-dashoffset', Math.random() > 0.5 ? humanLength : -humanLength)\n      .transition().duration(1000).delay(Math.random() * 700)\n        .attr('stroke-dashoffset', 0)\n        .transition().duration(500)\n          .attr('fill-opacity', 0.4);\n\n    d3.select(lineBlurElement)\n      .attr('stroke-dashoffset', -lineLength)\n      .attr('stroke-opacity', 0.6);\n\n    d3.select(lineElement)\n      .attr('stroke-dashoffset', -lineLength)\n      .attr('stroke-opacity', 1);\n\n    // Load the disease circles\n    d3.select(diseasesElement).selectAll('circle')\n      .data(data.filter((d) => diagnosesToShow.includes(d.diagnosis)))\n      .join('circle')\n        .attr('class', 'to-blur')\n        .attr('cx', (d) => ageScale(d.age))\n        .attr('cy', (d) => tempScale(d.temp))\n        .attr('r', 0)\n        .attr('fill', '#5BC0EB')\n        .attr('fill-opacity', 0.6);\n  });\n\n  $: line = d3.line()\n    .x((d) => ageScale(d.age))\n    .y((d) => tempScale(d.temp))\n    .curve(d3.curveMonotoneX);\n\n  $: maxAge = d3.max(data.map((d) => d.age));\n  $: minAge = d3.min(data.map((d) => d.age));\n  $: maxTemp = d3.max(data.map((d) => d.temp));\n  $: minTemp = d3.min(data.map((d) => d.temp));\n\n  $: diseaseRadius = Math.min($width, $height) / 100;\n\n  $: animate(expanded);\n</script>\n\n<g class=\"individual\" bind:this={parentElement}>\n  <g class=\"human-icon\" transform=\"translate({x} {y}) scale(0.6)\">\n    <path class=\"human\"\n          bind:this={humanElement}\n          d={human}\n          fill={color}\n          fill-opacity=0\n          stroke-dasharray=\"{humanLength} {humanLength}\"\n          on:click={() => expanded = !expanded} />\n  </g>\n  <g class=\"diseases\"\n     bind:this={diseasesElement}>\n  </g>\n  <g class=\"temperature-line\">\n    <path class=\"line-blur to-blur\"\n          bind:this={lineBlurElement}\n          d={line(data)}\n          stroke={color}\n          stroke-dasharray=\"{lineLength} {lineLength}\" />\n    <path class=\"line to-blur\"\n          bind:this={lineElement}\n          d={line(data)}\n          stroke-dasharray=\"{lineLength} {lineLength}\" />\n  </g>\n  <g class=\"hover-rect\">\n    {#if expanded}\n      <rect class:hide={expanded}\n            bind:this={rectElement}\n            x={ageScale(minAge)}\n            y={tempScale(maxTemp)}\n            width={ageScale(maxAge) - ageScale(minAge)}\n            height={tempScale(minTemp) - tempScale(maxTemp)}\n            on:click={() => expanded = false} />\n    {/if}\n  </g>\n</g>\n\n<style>\n  path:hover, rect:hover {\n    cursor: pointer;\n  }\n\n  path.human {\n    stroke: var(--purple);\n    stroke-width: calc(1.6 * 0.2vmin);\n    filter: url(#point-light);\n  }\n\n  path.line, path.line-blur {\n    fill: none;\n    fill-opacity: 0;\n  }\n\n  path.line {\n    stroke: var(--purple);\n    stroke-width: 0.2vmin;\n  }\n\n  path.line-blur {\n    stroke-width: 0.3vmin;\n    filter: url(#filter-blur);\n  }\n\n  rect {\n    stroke: none;\n    fill: transparent;\n  }\n</style>\n"
  ],
  "names": [],
  "mappings": "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"
}